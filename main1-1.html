<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BookSwap - Каталог книг</title>
    <link rel="script" href="cookie.js">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="main.css">
    <script src="cookie.js"></script>
</head>
<body>
    <header class="header">
        <div class="logo-container">
            <img src="logo.png" class="logo" alt="BookSwap Logo" onerror="this.src='placeholder-logo.png'">
            <h1>BookSwap</h1>
        </div>
        <div id="authContainer">
            <form class="auth-form">
                <div class="auth-fields">
                    <input type="text" placeholder="Логин" name="login">
                    <input type="password" placeholder="Пароль" name="password">
                    <button type="submit"><a href="login.html">Войти</a></button>
                </div>
                <div class="register-link">
                    <a href="register.html">Нет аккаунта? Зарегистрируйтесь!</a>
                </div>
            </form>
        </div>
    </header>

    <nav class="nav">
        <ul class="nav-list">
            <li><a href="main1-1.html">Главная</a></li>
            <li><a href="book_trade_3.html">Начать обмен</a></li>
            <li><a href="user.html">Мои обмены</a></li>
            <li><a href="link.html">О нас</a></li>
        </ul>
    </nav>

    <main class="main-content">
        <div class="content-wrapper">
            <!-- Новый блок с текстом по центру страницы -->
            <div class="welcome-text">
                <h2>Добро пожаловать на BookSwap!</h2>
                <p>
                    Обмен книгами (буккроссер) становится всё более популярен. Это даёт шанс бумажным книгам продлить свою жизнь, помогает владельцам книг делиться хорошими историями и получать новые впечатления.
                </p>
                <p>
                    Все буккроссеры любят свои книги и любят их читать. Они щедрые, новаторские, дружелюбные, добросердечные, веселые и образованные люди.
                </p>
                <p>
                    Наш сайт предлагает совершить не просто обмен, а добавить к этому увлекательному процессу элемент сюрприза. Подбор книг для обмена будет выполнен по пожеланиям участников, но только при получении книги станет известно, какая именно книга будет радовать своего владельца. Интересно? Тогда начинайте обмен и приглашайте своих друзей поучаствовать!
                </p>
            </div>
        </div>
    </main>

    <footer>
        © BookSwap 2023. Все права защищены.
    </footer>

    <script>
        // Код авторизации и работы с куками остается без изменений
        const cookies = document.cookie.split('; ');
        const myDataCookie = cookies.find(row => row.startsWith('myData='));
        const _id = myDataCookie ? myDataCookie.split('=')[1] : null;
        console.log(_id);

        function updateAuthDisplay() {
            let karp = localStorage.getItem("userId");
            const username = getCookie(`myUsername`);
            const authContainer = document.getElementById('authContainer');
            if (_id) {
                authContainer.innerHTML = `
                    <p>Добро пожаловать, ${username}!</p>
                    <a href="#" onclick="logout()">Выйти</a>
                `;
            } else {
                authContainer.innerHTML = `
                    <form id="authForm" class="auth-form">
                        <div class="auth-fields">
                            <input type="text" placeholder="Логин" name="login">
                            <input type="password" placeholder="Пароль" name="password">
                            <button type="submit" onclick="handleLogin(event)">Войти</button>
                        </div>
                        <div class="register-link">
                            <a href="register.html">Нет аккаунта? Зарегистрируйтесь!</a>
                        </div>
                    </form>
                `;
            }
        }

        function handleLogin(event) {
            event.preventDefault();
            const login = document.querySelector('input[name="login"]').value;
            const password = document.querySelector('input[name="password"]').value;

            const params = new URLSearchParams({
                userName: login,
                password: password
            });

            fetch(`https://serverbook-1-dhna.onrender.com/api/login?${params.toString()}`)
                .then(response => {
                    if (!response.ok) {
                        alert("Ошибка входа");
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    localStorage.setItem('userId', data.userId);
                    localStorage.setItem('username', data.username);
                    updateAuthDisplay();
                    alert('Вы успешно вошли в систему!');
                })
                .catch(error => {
                    console.error('Ошибка:', error);
                    alert('Ошибка авторизации: ' + error.message);
                });
        }

        function logout() {
            updateAuthDisplay();
        }

        document.addEventListener('DOMContentLoaded', updateAuthDisplay);
    </script>
    <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'91bd3e9a6d92b039',t:'MTc0MTIxNTc4NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>